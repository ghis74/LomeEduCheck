<!DOCTYPE html>
<html lang="fr">
<!-- =============== création de la page des professeurs ================ -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Utilisateurs</title>
    <link rel="stylesheet" type="text/css" href="../assets/styles/d copy.css">
    <link rel="stylesheet" href="../assets/styles/style copy.css">
</head>

<body>
    <!-- =============== Navigation ================ -->
    <div class="container">
        <div class="navigation">
            <ul>
                <li>
                    <a href="#">
                        <span class="icon">
                            <img src="../assets/media/img1.png" alt="Mon Logo" width="140">
                        </span>
                        <span class="title"></span>
                    </a>
                </li>
                <li>
                    <a href="../src/index.html">
                        <span class="icon">
                            <ion-icon name="home-outline"></ion-icon>
                        </span>
                        <span class="title">Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="../src/utilisateurs.html">
                        <span class="icon">
                            <ion-icon name="people-outline"></ion-icon>
                        </span>
                        <span class="title">Professeur</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="icon">
                            <ion-icon name="chatbubble-outline"></ion-icon>
                        </span>
                        <span class="title">Messages</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="icon">
                            <ion-icon name="help-outline"></ion-icon>
                        </span>
                        <span class="title">Emargement</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="icon">
                            <ion-icon name="historical-outline"></ion-icon>
                        </span>
                        <span class="title">Historique</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="icon">
                            <ion-icon name="settings-outline"></ion-icon>
                        </span>
                        <span class="title">Paramètres</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="icon">
                            <ion-icon name="lock-closed-outline"></ion-icon>
                        </span>
                        <span class="title">Mot de passe</span>
                    </a>
                </li>
                <li>
                    <a href="#">
                        <span class="icon">
                            <ion-icon name="log-out-outline"></ion-icon>
                        </span>
                        <span class="title">Se déconnecter</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- ========================= Main ==================== -->
        <div class="main">
            <div class="topbar">
                <div class="toggle">
                    <ion-icon name="menu-outline"></ion-icon>
                </div>
                <div class="search">
                    <label>
                        <input type="text" placeholder="Recherche">
                        <ion-icon name="search-outline"></ion-icon>
                    </label>
                </div>
                <div class="user">
                    <img src="/assets/media/customer 3.png" alt="">
                </div>
            </div>
            <!-- ================= New Customers ================ -->
            <div class="recentCustomers">
                <div class="cardHeader">
                    <h2>Liste des professeurs</h2>
                </div>
                <table class="centered-table profs-table" id="profsTable">
                    <!-- Les professeurs seront insérés ici par JavaScript -->
                </table>
            </div>

            <section class="section">
                <div class="container">
                    <h1 class="title">Gestion des Utilisateurs</h1>
                    <table>
                        <tr>
                            <td>
                                <!-- Formulaire pour récupérer un utilisateur -->
                                <div class="form-container">
                                    <div class="cardHeader">
                                        <h2 class="subtitle">Récupérer un utilisateur</h2>
                                    </div>
                                    <form id="getForm">
                                        <div class="field">
                                            <label class="label">ID d'Utilisateur</label>
                                            <input class="input" type="number" id="getId" required>
                                        </div>
                                        <button class="button" type="submit">Récupérer</button>
                                    </form>
                                    <pre id="getResult"></pre>
                                </div>
                            </td>
                            <td>
                                <!-- Formulaire pour créer un utilisateur -->
                                <div class="form-container">
                                    <div class="cardHeader">
                                        <h2 class="subtitle">Créer un utilisateur</h2>
                                    </div>
                                    <form id="postForm">
                                        <div class="field">
                                            <label class="label">Nom</label>
                                            <input class="input" type="text" id="postNom" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">Prénoms</label>
                                            <input class="input" type="text" id="postPrenoms" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">Téléphone</label>
                                            <input class="input" type="text" id="postTelephone" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">Email</label>
                                            <input class="input" type="email" id="postEmail" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">Adresse</label>
                                            <input class="input" type="text" id="postAdresse" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">Mot de Passe</label>
                                            <input class="input" type="password" id="postMotpass" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">ID Rôles</label>
                                            <input class="input" type="number" id="postIdRoles" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">ID Confirmations</label>
                                            <input class="input" type="number" id="postIdConfirmations" required>
                                        </div>
                                        <button class="button is-success" type="submit">Créer</button>
                                    </form>
                                    <pre id="postResult"></pre>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <!-- Formulaire pour mettre à jour un utilisateur -->
                                <div class="form-container">
                                    <div class="cardHeader">
                                        <h2 class="subtitle">Mettre à jour un utilisateur</h2>
                                    </div>
                                    <form id="putForm">
                                        <div class="field">
                                            <label class="label">Nom</label>
                                            <input class="input" type="text" id="putNom" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">Prénoms</label>
                                            <input class="input" type="text" id="putPrenoms" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">Téléphone</label>
                                            <input class="input" type="text" id="putTelephone" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">Email</label>
                                            <input class="input" type="email" id="putEmail" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">Adresse</label>
                                            <input class="input" type="text" id="putAdresse" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">Mot de Passe</label>
                                            <input class="input" type="password" id="putMotpass" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">ID Rôles</label>
                                            <input class="input" type="number" id="putIdRoles" required>
                                        </div>
                                        <div class="field">
                                            <label class="label">ID Confirmations</label>
                                            <input class="input" type="number" id="putIdConfirmations" required>
                                        </div>
                                        <button class="button is-warning" type="submit">Mettre à jour</button>
                                    </form>
                                    <pre id="putResult"></pre>
                                </div>
                            </td>
                            <td>
                                <!-- Formulaire pour supprimer un utilisateur -->
                                <div class="form-container">
                                    <div class="cardHeader">
                                        <h2 class="subtitle">Supprimer un utilisateur</h2>
                                    </div>
                                    <form id="deleteForm">
                                        <div class="field">
                                            <label class="label">ID d'Utilisateur</label>
                                            <input class="input" type="number" id="deleteId" required>
                                        </div>
                                        <button class="button is-danger" type="submit">Supprimer</button>
                                    </form>
                                    <pre id="deleteResult"></pre>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </section>
        </div>
    </div>

    <script src="../assets/scripts/main.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const API_URL = "path/to/your/api.php";  // Remplacez ceci par le chemin correct vers votre API

            // Récupérer tous les utilisateurs et les afficher
            const fetchUsers = () => {
                fetch(API_URL, { method: 'GET' })
                    .then(response => response.json())
                    .then(users => {
                        const profsTable = document.getElementById('profsTable');
                        profsTable.innerHTML = '';  // Clear existing rows
                        users.forEach(user => {
                            let row = `<tr><td><h4>${user.nom} ${user.prenoms} <br></h4></td></tr>`;
                            profsTable.innerHTML += row;
                        });
                    })
                    .catch(error => console.error('Error fetching users:', error));
            };

            // Gestion de la récupération d'un utilisateur par ID
            document.getElementById('getForm').addEventListener('submit', event => {
                event.preventDefault();
                const id = document.getElementById('getId').value;
                fetch(`${API_URL}?id=${id}`, { method: 'GET' })
                    .then(response => response.json())
                    .then(user => {
                        document.getElementById('getResult').innerText = JSON.stringify(user, null, 2);
                    })
                    .catch(error => console.error('Error fetching user:', error));
            });

            // Gestion de la création d'un utilisateur
            document.getElementById('postForm').addEventListener('submit', event => {
                event.preventDefault();
                const data = {
                    nom: document.getElementById('postNom').value,
                    prenoms: document.getElementById('postPrenoms').value,
                    telephone: document.getElementById('postTelephone').value,
                    email: document.getElementById('postEmail').value,
                    adresse: document.getElementById('postAdresse').value,
                    motpass: document.getElementById('postMotpass').value,
                    Id_roles: document.getElementById('postIdRoles').value,
                    Id_confirmations: document.getElementById('postIdConfirmations').value,
                };
                fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                })
                    .then(response => response.json())
                    .then(result => {
                        document.getElementById('postResult').innerText = JSON.stringify(result, null, 2);
                        fetchUsers();  // Refresh the list of users
                    })
                    .catch(error => console.error('Error creating user:', error));
            });

            // Gestion de la mise à jour d'un utilisateur
            document.getElementById('putForm').addEventListener('submit', event => {
                event.preventDefault();
                const data = {
                    nom: document.getElementById('putNom').value,
                    prenoms: document.getElementById('putPrenoms').value,
                    telephone: document.getElementById('putTelephone').value,
                    email: document.getElementById('putEmail').value,
                    adresse: document.getElementById('putAdresse').value,
                    motpass: document.getElementById('putMotpass').value,
                    Id_roles: document.getElementById('putIdRoles').value,
                    Id_confirmations: document.getElementById('putIdConfirmations').value,
                };
                fetch(API_URL, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                })
                    .then(response => response.json())
                    .then(result => {
                        document.getElementById('putResult').innerText = JSON.stringify(result, null, 2);
                        fetchUsers();  // Refresh the list of users
                    })
                    .catch(error => console.error('Error updating user:', error));
            });

            // Gestion de la suppression d'un utilisateur
            document.getElementById('deleteForm').addEventListener('submit', event => {
                event.preventDefault();
                const id = document.getElementById('deleteId').value;
                fetch(`${API_URL}?id=${id}`, { method: 'DELETE' })
                    .then(response => response.json())
                    .then(result => {
                        document.getElementById('deleteResult').innerText = JSON.stringify(result, null, 2);
                        fetchUsers();  // Refresh the list of users
                    })
                    .catch(error => console.error('Error deleting user:', error));
            });

            // Initial fetch of users to display
            fetchUsers();
        });
    </script>
</body>

</html>